syntax = "proto3";

package users;

import "google/protobuf/timestamp.proto";

option java_package = "pl.bpiatek.contracts.user";
option java_outer_classname = "UserLifecycleEventProto";

/*
 * Published to "user-lifecycle-events" on user registration, password reset, etc.
 */
message UserLifecycleEvent {
  string event_id = 1;
  google.protobuf.Timestamp event_timestamp = 2;

  oneof event_payload {
    UserRegistered user_registered = 3;
    PasswordResetRequested password_reset_requested = 4;
    UserPasswordChanged user_password_changed = 5;
  }
}

/**
 * Published when a new user is trying to register
 */
message UserRegistered {
  // The unique identifier of the user (e.g., UUID).
  string user_id = 1;

  // The email of the user
  string email = 2;

  // verification url for user
  string verification_url = 3;
}

/**
 * Published when a user requests a password reset
 */
message PasswordResetRequested {
  // The unique identifier of the user (e.g., UUID).
  string user_id = 1;

  // The email of the user
  string email = 2;

  // Reset url for user
  string reset_url = 3;
}

/**
 * Published when a user changes their password
 */
message UserPasswordChanged {
  // The unique identifier of the user (e.g., UUID).
  string user_id = 1;

  // The email of the user
  string email = 2;

  // Optional: Very useful for security alerts
  // string ip_address = 3;
  // string user_agent = 4;
}